# Define the path to the REG file
$regFilePath = "C:\Path\To\DisableIPv6.reg"
$regFolderPath = [System.IO.Path]::GetDirectoryName($regFilePath)
$folderExisted = $false

# Check if the folder exists
if (-Not (Test-Path -Path $regFolderPath)) {
    # The folder does not exist, so create it
    New-Item -Path $regFolderPath -ItemType Directory | Out-Null
    $folderExisted = $false
} else {
    $folderExisted = $true
}

# Create the content of the REG file
$regContent = @"
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip6\Parameters]
"DisabledComponents"=dword:ffffffff
"@

# Save the content to the REG file
Set-Content -Path $regFilePath -Value $regContent

# Import the REG file into the registry
& reg.exe import $regFilePath

# Delete the REG file after importing
Remove-Item -Path $regFilePath -Force

# If the folder was created by this script, delete it
if (-Not $folderExisted) {
    Remove-Item -Path $regFolderPath -Recurse -Force
}

# Notify the user that the IPv6 settings have been updated
Write-Host "The IPv6 settings have been updated in the registry. The REG file has been deleted. Please restart your computer for changes to take effect." -ForegroundColor Green
